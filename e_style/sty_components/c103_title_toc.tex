% TOC

\setcounter{secnumdepth}{3}
\setcounter{tocdepth}{3}

% --- Command for a two-column, brief ToC (depth = 2) ---
\newcommand{\brieftoc}{%
  \begingroup
  \etocsettocstyle
    {% Before the ToC
      \clearpage
      % Conditionally set the title as a chapter or section
      \ifcsdef{chapter}{%
        \chapter*{Brief Contents}%
        \etoctoccontentsline{chapter}{Brief Contents}%
      }{%
        \section*{Brief Contents}%
        \etoctoccontentsline{section}{Brief Contents}%
      }
    }
    {}% After the ToC
  \setcounter{tocdepth}{2}% Set local depth for this ToC
  \begin{multicols}{2}
    \tableofcontents
  \end{multicols}
  \endgroup
}

% --- Command for a single-column, detailed ToC (depth = 3) ---
\newcommand{\detailedtoc}{%
  \begingroup
  \etocsettocstyle
    {% Before the ToC
      \clearpage
      % Conditionally set the title as a chapter or section
      \ifcsdef{chapter}{%
        \chapter*{Detailed Contents}%
        \etoctoccontentsline{chapter}{Detailed Contents}%
      }{%
        \section*{Detailed Contents}%
        \etoctoccontentsline{section}{Detailed Contents}%
      }
    }
    {}% After the ToC
  \setcounter{tocdepth}{3}% Set local depth for this ToC
  \tableofcontents
  \endgroup
}

% --- Command for the main ToC ---
\newcommand{\mytoc}{%
    \clearpage
    { % Keep etoc settings local to this ToC
    \etocsettocstyle{
        \setcounter{tocdepth}{3} % Main ToC depth
        \renewcommand{\contentsname}{Contents}
        % Conditionally set the title as a chapter or section
        \ifcsdef{chapter}{%
            \chapter*{\contentsname}%
        }{%
            \section*{\contentsname}%
        }
    }{%
        % Add the ToC itself to the list of contents
        \ifcsdef{chapter}{%
            \etoctoccontentsline{chapter}{\contentsname}%
        }{%
            \etoctoccontentsline{section}{\contentsname}%
        }
    }
    \tableofcontents
    }
}

% --- Command to set up a local ToC (e.g., at the start of a chapter) ---
\newcommand{\setuplocaltoc}{%
    \etocsettocstyle{
        \setcounter{tocdepth}{3}
        \rule{\linewidth}{1pt}
        \vskip0.5\baselineskip\parindent0em
    }{\vspace{-0.5em}\rule{\linewidth}{1pt}\vspace{2em}}
}

%-----------------------------------------------------------------------
%\etoctocstyle[⟨kind⟩]{⟨number_of_columns⟩}{⟨title⟩}

% part toc color
% \titlecontents provided by titletoc package [deprecated, use etoc instead]
% Define a custom TOC line style for parts
% Customizing the TOC
%\etocsettocstyle{⟨before_toc⟩}{⟨after_toc⟩}
%\etocsetstyle{⟨levelname⟩}{⟨start⟩}{⟨prefix⟩}{⟨contents⟩}{⟨finish⟩}

\def\mydotfill{\unskip\nobreak\leaders\hbox{\hss\ . \hss}\hfill\nobreak\relax}
%\hss = \hskip 0pt plus 1fill minus 1fill

\etocsetstyle{part}
    {\begingroup\parindent 0pt \nobreak \etocskipfirstprefix}
    {\pagebreak[3]\bigskip}
    {\normalsize\rmfamily\centering \color{red} %\scshape 
    \etocifnumbered{
      Part \etocnumber{} -- 
      }{
    }\MakeUppercase{\etocthename}\par} 
    {\endgroup}

\etocsetstyle{chapter}
    {\begingroup}
    {\addvspace{0.5em}\parindent0pt \color{black}\small} % Pre-code
    {\etocifnumbered{%
    \etocnumber\hspace{0.5em} \MakeUppercase{\etocthename}\hfill  \etocpage\par \addvspace{0.25em}
    }{%
      \MakeUppercase{\etocthename}\hfill \etocpage\par \addvspace{0.25em}
    }}
    {\endgroup\addvspace{0.2em}} % Post-code

\etocsetstyle{section}
    {\begingroup\addvspace{0.25em}\leftskip0em\parindent0pt\smallskip}
    {\footnotesize} % Pre-code
    {\etocifnumbered{%
    \etocnumber\hspace{0.3em} \etocname\mydotfill  \etocpage\par \addvspace{0.25em}
    }{%
    \etocname\hfill \etocpage\par\addvspace{0.25em}
    }}
    {\endgroup\par\medskip} % Post-code

\etocsetstyle{subsection}
  {\begingroup \leftskip1em \parfillskip 0pt plus 1fil\relax \nobreak}
  {\footnotesize\rmfamily\mdseries}
  {\etocifnumbered{%
  \etocnumber\hspace{0.3em} \etocname\mydotfill  \etocpage\par
  }{%
  \etocname\hfill \etocpage\par
  }}
  {\endgroup\par\smallskip}

\etocsetstyle{subsubsection}
  {\begingroup \leftskip3em \parfillskip 0pt plus 1fil\relax \nobreak}
  {\footnotesize\rmfamily\mdseries}
  {\etocifnumbered{%
  \etocnumber\hspace{0.3em} \etocname\mydotfill  \etocpage\par
  }{%
  \etocname\hfill \etocpage\par
  }}
  {\endgroup\par\smallskip}

%\etocsetstyle{appendix}
